<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>附录A: asynquence 库 | GitBlogs with Vue</title>
    <meta name="description" content="成长没有偏旁，所以它才孤独。">
    <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.09811c5e.css" as="style"><link rel="preload" href="/assets/js/app.0ac9f99e.js" as="script"><link rel="preload" href="/assets/js/2.4185071d.js" as="script"><link rel="preload" href="/assets/js/69.890073fd.js" as="script"><link rel="prefetch" href="/assets/js/10.b2ec22cc.js"><link rel="prefetch" href="/assets/js/100.8144e999.js"><link rel="prefetch" href="/assets/js/101.508e8894.js"><link rel="prefetch" href="/assets/js/102.823297dd.js"><link rel="prefetch" href="/assets/js/103.41cabe85.js"><link rel="prefetch" href="/assets/js/104.6b46c2c1.js"><link rel="prefetch" href="/assets/js/105.37cb8585.js"><link rel="prefetch" href="/assets/js/106.198d2171.js"><link rel="prefetch" href="/assets/js/107.b876099f.js"><link rel="prefetch" href="/assets/js/108.26e09556.js"><link rel="prefetch" href="/assets/js/109.44b2d8ba.js"><link rel="prefetch" href="/assets/js/11.21fb839b.js"><link rel="prefetch" href="/assets/js/110.f0a2316e.js"><link rel="prefetch" href="/assets/js/111.6a6f2933.js"><link rel="prefetch" href="/assets/js/112.ec4ac452.js"><link rel="prefetch" href="/assets/js/113.5fb42798.js"><link rel="prefetch" href="/assets/js/114.e188157a.js"><link rel="prefetch" href="/assets/js/115.cf43c353.js"><link rel="prefetch" href="/assets/js/116.94644367.js"><link rel="prefetch" href="/assets/js/117.9b702fe5.js"><link rel="prefetch" href="/assets/js/118.a7e44ae4.js"><link rel="prefetch" href="/assets/js/119.3bc8cbfe.js"><link rel="prefetch" href="/assets/js/12.614985c0.js"><link rel="prefetch" href="/assets/js/120.08b7d2a4.js"><link rel="prefetch" href="/assets/js/121.8b4d6743.js"><link rel="prefetch" href="/assets/js/122.f7e344d4.js"><link rel="prefetch" href="/assets/js/123.9760a46d.js"><link rel="prefetch" href="/assets/js/124.dcba4f24.js"><link rel="prefetch" href="/assets/js/125.36ffba46.js"><link rel="prefetch" href="/assets/js/126.1d4243b2.js"><link rel="prefetch" href="/assets/js/127.9ac39adc.js"><link rel="prefetch" href="/assets/js/128.9821c3fe.js"><link rel="prefetch" href="/assets/js/129.9975f8e2.js"><link rel="prefetch" href="/assets/js/13.6a8a7c06.js"><link rel="prefetch" href="/assets/js/130.5e7367e4.js"><link rel="prefetch" href="/assets/js/131.f4859bf9.js"><link rel="prefetch" href="/assets/js/132.fb6d60ad.js"><link rel="prefetch" href="/assets/js/133.9917f8d1.js"><link rel="prefetch" href="/assets/js/134.55ed0a58.js"><link rel="prefetch" href="/assets/js/135.1595630b.js"><link rel="prefetch" href="/assets/js/136.c40ef3b3.js"><link rel="prefetch" href="/assets/js/137.cd70db6c.js"><link rel="prefetch" href="/assets/js/138.d34c1c65.js"><link rel="prefetch" href="/assets/js/139.6ca5e2a4.js"><link rel="prefetch" href="/assets/js/14.dd307cdf.js"><link rel="prefetch" href="/assets/js/140.d679cd8d.js"><link rel="prefetch" href="/assets/js/141.3d635f16.js"><link rel="prefetch" href="/assets/js/142.264221ce.js"><link rel="prefetch" href="/assets/js/143.f30e01b4.js"><link rel="prefetch" href="/assets/js/144.67d35e34.js"><link rel="prefetch" href="/assets/js/145.9ce44fab.js"><link rel="prefetch" href="/assets/js/146.61d59226.js"><link rel="prefetch" href="/assets/js/147.9ecd7b79.js"><link rel="prefetch" href="/assets/js/148.b690e86f.js"><link rel="prefetch" href="/assets/js/149.1cc2e11f.js"><link rel="prefetch" href="/assets/js/15.f8aa95da.js"><link rel="prefetch" href="/assets/js/150.d708a450.js"><link rel="prefetch" href="/assets/js/151.ae9f03c4.js"><link rel="prefetch" href="/assets/js/152.e3886b0a.js"><link rel="prefetch" href="/assets/js/153.fabfb2ca.js"><link rel="prefetch" href="/assets/js/154.9dc84c76.js"><link rel="prefetch" href="/assets/js/155.d47c1e83.js"><link rel="prefetch" href="/assets/js/156.90ca444c.js"><link rel="prefetch" href="/assets/js/157.deacae44.js"><link rel="prefetch" href="/assets/js/158.38bd8b11.js"><link rel="prefetch" href="/assets/js/159.1d688da5.js"><link rel="prefetch" href="/assets/js/16.a9c85597.js"><link rel="prefetch" href="/assets/js/160.ca03b440.js"><link rel="prefetch" href="/assets/js/161.471a464e.js"><link rel="prefetch" href="/assets/js/162.66434e3e.js"><link rel="prefetch" href="/assets/js/163.7dbebdc5.js"><link rel="prefetch" href="/assets/js/164.adac07a2.js"><link rel="prefetch" href="/assets/js/165.8f077c48.js"><link rel="prefetch" href="/assets/js/166.c18cf36e.js"><link rel="prefetch" href="/assets/js/167.9b8b6e7d.js"><link rel="prefetch" href="/assets/js/168.661fa81b.js"><link rel="prefetch" href="/assets/js/169.0ff2751e.js"><link rel="prefetch" href="/assets/js/17.c0eacdd5.js"><link rel="prefetch" href="/assets/js/170.70068e59.js"><link rel="prefetch" href="/assets/js/171.d3c68a27.js"><link rel="prefetch" href="/assets/js/172.a29833a6.js"><link rel="prefetch" href="/assets/js/173.df50a5c9.js"><link rel="prefetch" href="/assets/js/174.01994178.js"><link rel="prefetch" href="/assets/js/175.78011c08.js"><link rel="prefetch" href="/assets/js/176.58a1e3ee.js"><link rel="prefetch" href="/assets/js/177.04082d52.js"><link rel="prefetch" href="/assets/js/178.253ff218.js"><link rel="prefetch" href="/assets/js/179.98e2d073.js"><link rel="prefetch" href="/assets/js/18.b01c13fc.js"><link rel="prefetch" href="/assets/js/180.2a21b562.js"><link rel="prefetch" href="/assets/js/181.b174c5a2.js"><link rel="prefetch" href="/assets/js/182.7bf81645.js"><link rel="prefetch" href="/assets/js/183.c5640660.js"><link rel="prefetch" href="/assets/js/184.97600802.js"><link rel="prefetch" href="/assets/js/185.34aefe00.js"><link rel="prefetch" href="/assets/js/186.4b5946d3.js"><link rel="prefetch" href="/assets/js/187.cd39fc00.js"><link rel="prefetch" href="/assets/js/188.22ff5baf.js"><link rel="prefetch" href="/assets/js/189.23c8eb18.js"><link rel="prefetch" href="/assets/js/19.6f6077cb.js"><link rel="prefetch" href="/assets/js/190.5eb4adfc.js"><link rel="prefetch" href="/assets/js/191.7df04996.js"><link rel="prefetch" href="/assets/js/192.2a340c98.js"><link rel="prefetch" href="/assets/js/193.b8fc6e5d.js"><link rel="prefetch" href="/assets/js/194.3d525117.js"><link rel="prefetch" href="/assets/js/195.ad1c59bf.js"><link rel="prefetch" href="/assets/js/196.a2d185d3.js"><link rel="prefetch" href="/assets/js/197.ac345d61.js"><link rel="prefetch" href="/assets/js/198.8057c332.js"><link rel="prefetch" href="/assets/js/199.7f581c66.js"><link rel="prefetch" href="/assets/js/20.2780edad.js"><link rel="prefetch" href="/assets/js/200.1559cafb.js"><link rel="prefetch" href="/assets/js/201.a4b0e3b2.js"><link rel="prefetch" href="/assets/js/202.4c3db817.js"><link rel="prefetch" href="/assets/js/203.a3c8767a.js"><link rel="prefetch" href="/assets/js/204.dd1f898f.js"><link rel="prefetch" href="/assets/js/205.db9b1d93.js"><link rel="prefetch" href="/assets/js/206.434fd172.js"><link rel="prefetch" href="/assets/js/207.43c19670.js"><link rel="prefetch" href="/assets/js/208.ba69b4a7.js"><link rel="prefetch" href="/assets/js/209.65c729ef.js"><link rel="prefetch" href="/assets/js/21.d076c050.js"><link rel="prefetch" href="/assets/js/210.57015f12.js"><link rel="prefetch" href="/assets/js/211.7d0f965c.js"><link rel="prefetch" href="/assets/js/212.fa118863.js"><link rel="prefetch" href="/assets/js/213.d923cf44.js"><link rel="prefetch" href="/assets/js/214.0f5586c3.js"><link rel="prefetch" href="/assets/js/215.509df477.js"><link rel="prefetch" href="/assets/js/216.85900112.js"><link rel="prefetch" href="/assets/js/217.feff8959.js"><link rel="prefetch" href="/assets/js/218.c05408e4.js"><link rel="prefetch" href="/assets/js/219.1634804b.js"><link rel="prefetch" href="/assets/js/22.f7ae340e.js"><link rel="prefetch" href="/assets/js/220.0448e716.js"><link rel="prefetch" href="/assets/js/221.582c22fc.js"><link rel="prefetch" href="/assets/js/222.d9be7dec.js"><link rel="prefetch" href="/assets/js/223.8b13123b.js"><link rel="prefetch" href="/assets/js/224.c572db91.js"><link rel="prefetch" href="/assets/js/225.cc638cdb.js"><link rel="prefetch" href="/assets/js/226.5bf8d8f9.js"><link rel="prefetch" href="/assets/js/227.fa652c80.js"><link rel="prefetch" href="/assets/js/228.dbe69c49.js"><link rel="prefetch" href="/assets/js/229.e2724795.js"><link rel="prefetch" href="/assets/js/23.e606a20c.js"><link rel="prefetch" href="/assets/js/230.917051fe.js"><link rel="prefetch" href="/assets/js/231.96da2931.js"><link rel="prefetch" href="/assets/js/232.595ec618.js"><link rel="prefetch" href="/assets/js/233.4fce2626.js"><link rel="prefetch" href="/assets/js/234.17163689.js"><link rel="prefetch" href="/assets/js/235.fd50779f.js"><link rel="prefetch" href="/assets/js/236.9c0a5f05.js"><link rel="prefetch" href="/assets/js/237.4f135ed3.js"><link rel="prefetch" href="/assets/js/238.68539393.js"><link rel="prefetch" href="/assets/js/239.84b34096.js"><link rel="prefetch" href="/assets/js/24.34080edb.js"><link rel="prefetch" href="/assets/js/240.f2850446.js"><link rel="prefetch" href="/assets/js/241.e85dacf1.js"><link rel="prefetch" href="/assets/js/242.e98a5a81.js"><link rel="prefetch" href="/assets/js/243.a69466e9.js"><link rel="prefetch" href="/assets/js/244.e88f0bfc.js"><link rel="prefetch" href="/assets/js/245.13418ee4.js"><link rel="prefetch" href="/assets/js/246.356a1966.js"><link rel="prefetch" href="/assets/js/247.5a048df4.js"><link rel="prefetch" href="/assets/js/248.c7bdf90f.js"><link rel="prefetch" href="/assets/js/249.f3db8e13.js"><link rel="prefetch" href="/assets/js/25.33421777.js"><link rel="prefetch" href="/assets/js/250.cb11e418.js"><link rel="prefetch" href="/assets/js/251.8e1667cd.js"><link rel="prefetch" href="/assets/js/252.32469a27.js"><link rel="prefetch" href="/assets/js/253.703e1c8e.js"><link rel="prefetch" href="/assets/js/254.38e2df8c.js"><link rel="prefetch" href="/assets/js/255.45c57ba5.js"><link rel="prefetch" href="/assets/js/256.8abf62c0.js"><link rel="prefetch" href="/assets/js/257.df6cd513.js"><link rel="prefetch" href="/assets/js/258.0b003686.js"><link rel="prefetch" href="/assets/js/259.f1f315a5.js"><link rel="prefetch" href="/assets/js/26.2df5939c.js"><link rel="prefetch" href="/assets/js/260.f6c04e86.js"><link rel="prefetch" href="/assets/js/261.4190474c.js"><link rel="prefetch" href="/assets/js/262.29b28cf1.js"><link rel="prefetch" href="/assets/js/263.75b87ef9.js"><link rel="prefetch" href="/assets/js/264.70d19ce1.js"><link rel="prefetch" href="/assets/js/265.d83549a7.js"><link rel="prefetch" href="/assets/js/266.53941b3b.js"><link rel="prefetch" href="/assets/js/267.a6e3f627.js"><link rel="prefetch" href="/assets/js/268.7cd31257.js"><link rel="prefetch" href="/assets/js/269.82b54e9a.js"><link rel="prefetch" href="/assets/js/27.2eb82dca.js"><link rel="prefetch" href="/assets/js/270.dcc4726b.js"><link rel="prefetch" href="/assets/js/271.038db6a8.js"><link rel="prefetch" href="/assets/js/272.a5f16019.js"><link rel="prefetch" href="/assets/js/273.e6b4cded.js"><link rel="prefetch" href="/assets/js/274.1c7c938b.js"><link rel="prefetch" href="/assets/js/275.b94d1b2e.js"><link rel="prefetch" href="/assets/js/276.aaec1ed2.js"><link rel="prefetch" href="/assets/js/277.85211993.js"><link rel="prefetch" href="/assets/js/278.0401f171.js"><link rel="prefetch" href="/assets/js/279.c41bddc9.js"><link rel="prefetch" href="/assets/js/28.527b1ad1.js"><link rel="prefetch" href="/assets/js/280.c840e740.js"><link rel="prefetch" href="/assets/js/281.f8ae3dad.js"><link rel="prefetch" href="/assets/js/282.1b02ace3.js"><link rel="prefetch" href="/assets/js/283.184228d5.js"><link rel="prefetch" href="/assets/js/284.e16f7a6a.js"><link rel="prefetch" href="/assets/js/285.c7df42a8.js"><link rel="prefetch" href="/assets/js/286.cd25e0e7.js"><link rel="prefetch" href="/assets/js/287.9815bfd6.js"><link rel="prefetch" href="/assets/js/288.77fea5c8.js"><link rel="prefetch" href="/assets/js/289.9860c528.js"><link rel="prefetch" href="/assets/js/29.358dfb0f.js"><link rel="prefetch" href="/assets/js/290.66f48ba0.js"><link rel="prefetch" href="/assets/js/291.eb2937e5.js"><link rel="prefetch" href="/assets/js/292.6188909b.js"><link rel="prefetch" href="/assets/js/293.e0a8dac4.js"><link rel="prefetch" href="/assets/js/294.bebeeb67.js"><link rel="prefetch" href="/assets/js/295.46565eab.js"><link rel="prefetch" href="/assets/js/296.d0c0f548.js"><link rel="prefetch" href="/assets/js/297.dcfdbea8.js"><link rel="prefetch" href="/assets/js/298.560793d5.js"><link rel="prefetch" href="/assets/js/299.485414ad.js"><link rel="prefetch" href="/assets/js/3.0c74c1d2.js"><link rel="prefetch" href="/assets/js/30.521a7573.js"><link rel="prefetch" href="/assets/js/300.71abf1e3.js"><link rel="prefetch" href="/assets/js/301.f82b6bee.js"><link rel="prefetch" href="/assets/js/302.ae5fb3c4.js"><link rel="prefetch" href="/assets/js/303.0c483fc1.js"><link rel="prefetch" href="/assets/js/304.ca70679c.js"><link rel="prefetch" href="/assets/js/305.319b858b.js"><link rel="prefetch" href="/assets/js/306.9d7b1226.js"><link rel="prefetch" href="/assets/js/307.f5609063.js"><link rel="prefetch" href="/assets/js/308.cb740ce4.js"><link rel="prefetch" href="/assets/js/309.9685f102.js"><link rel="prefetch" href="/assets/js/31.f417bc2f.js"><link rel="prefetch" href="/assets/js/310.69dad290.js"><link rel="prefetch" href="/assets/js/311.fa3c972d.js"><link rel="prefetch" href="/assets/js/312.a29cb828.js"><link rel="prefetch" href="/assets/js/313.8c7cc684.js"><link rel="prefetch" href="/assets/js/314.b0daedb3.js"><link rel="prefetch" href="/assets/js/315.0680eb69.js"><link rel="prefetch" href="/assets/js/316.6262bea6.js"><link rel="prefetch" href="/assets/js/317.d3174c08.js"><link rel="prefetch" href="/assets/js/318.150e1140.js"><link rel="prefetch" href="/assets/js/319.3b507c74.js"><link rel="prefetch" href="/assets/js/32.1d771457.js"><link rel="prefetch" href="/assets/js/320.6013036c.js"><link rel="prefetch" href="/assets/js/321.975d3190.js"><link rel="prefetch" href="/assets/js/322.fd79ecc1.js"><link rel="prefetch" href="/assets/js/323.89d039e9.js"><link rel="prefetch" href="/assets/js/324.5f603397.js"><link rel="prefetch" href="/assets/js/325.d9eb31ec.js"><link rel="prefetch" href="/assets/js/326.50296f84.js"><link rel="prefetch" href="/assets/js/327.f795e662.js"><link rel="prefetch" href="/assets/js/328.4a041a08.js"><link rel="prefetch" href="/assets/js/329.4140ae4c.js"><link rel="prefetch" href="/assets/js/33.3cec422b.js"><link rel="prefetch" href="/assets/js/330.7dbdba98.js"><link rel="prefetch" href="/assets/js/331.d406f7b4.js"><link rel="prefetch" href="/assets/js/332.6a9ce04b.js"><link rel="prefetch" href="/assets/js/333.848f0c35.js"><link rel="prefetch" href="/assets/js/334.29c46841.js"><link rel="prefetch" href="/assets/js/335.5fc15f58.js"><link rel="prefetch" href="/assets/js/336.f9730548.js"><link rel="prefetch" href="/assets/js/337.9ea10e6a.js"><link rel="prefetch" href="/assets/js/338.0737ba32.js"><link rel="prefetch" href="/assets/js/339.44d1d876.js"><link rel="prefetch" href="/assets/js/34.6ee9528b.js"><link rel="prefetch" href="/assets/js/340.d99948bd.js"><link rel="prefetch" href="/assets/js/341.2b331e66.js"><link rel="prefetch" href="/assets/js/342.39a24a14.js"><link rel="prefetch" href="/assets/js/343.735c34e1.js"><link rel="prefetch" href="/assets/js/344.d8c55862.js"><link rel="prefetch" href="/assets/js/345.7f9db595.js"><link rel="prefetch" href="/assets/js/346.abcc52db.js"><link rel="prefetch" href="/assets/js/347.acdb9c73.js"><link rel="prefetch" href="/assets/js/348.c10510ac.js"><link rel="prefetch" href="/assets/js/349.3664b14e.js"><link rel="prefetch" href="/assets/js/35.deba8288.js"><link rel="prefetch" href="/assets/js/350.b8e5b85d.js"><link rel="prefetch" href="/assets/js/351.6b9aad9a.js"><link rel="prefetch" href="/assets/js/352.1f8ca98c.js"><link rel="prefetch" href="/assets/js/353.34118470.js"><link rel="prefetch" href="/assets/js/354.6828a0ae.js"><link rel="prefetch" href="/assets/js/355.0300b485.js"><link rel="prefetch" href="/assets/js/356.fa7428e2.js"><link rel="prefetch" href="/assets/js/357.d1bd8d29.js"><link rel="prefetch" href="/assets/js/358.530b7e79.js"><link rel="prefetch" href="/assets/js/359.98607cda.js"><link rel="prefetch" href="/assets/js/36.3f1c4733.js"><link rel="prefetch" href="/assets/js/360.1fee0b8d.js"><link rel="prefetch" href="/assets/js/361.16e5a4bd.js"><link rel="prefetch" href="/assets/js/362.0513c030.js"><link rel="prefetch" href="/assets/js/363.70633093.js"><link rel="prefetch" href="/assets/js/364.58dbea64.js"><link rel="prefetch" href="/assets/js/365.1e8ae9c0.js"><link rel="prefetch" href="/assets/js/366.ceb9e600.js"><link rel="prefetch" href="/assets/js/367.44227230.js"><link rel="prefetch" href="/assets/js/368.1a287838.js"><link rel="prefetch" href="/assets/js/369.54891ffb.js"><link rel="prefetch" href="/assets/js/37.ab8606b7.js"><link rel="prefetch" href="/assets/js/370.7022302e.js"><link rel="prefetch" href="/assets/js/371.f2019cd5.js"><link rel="prefetch" href="/assets/js/372.f5f15a87.js"><link rel="prefetch" href="/assets/js/373.95a95c1f.js"><link rel="prefetch" href="/assets/js/374.c7b13e42.js"><link rel="prefetch" href="/assets/js/375.ae1bfd86.js"><link rel="prefetch" href="/assets/js/376.813608bd.js"><link rel="prefetch" href="/assets/js/377.d6dab03c.js"><link rel="prefetch" href="/assets/js/378.76b606ec.js"><link rel="prefetch" href="/assets/js/379.a14bf56a.js"><link rel="prefetch" href="/assets/js/38.2afaca16.js"><link rel="prefetch" href="/assets/js/380.c5967262.js"><link rel="prefetch" href="/assets/js/381.ab1b4e62.js"><link rel="prefetch" href="/assets/js/382.c440eb57.js"><link rel="prefetch" href="/assets/js/383.5564a2c2.js"><link rel="prefetch" href="/assets/js/384.f7072cd3.js"><link rel="prefetch" href="/assets/js/385.ca6fbc76.js"><link rel="prefetch" href="/assets/js/386.6f9e667b.js"><link rel="prefetch" href="/assets/js/387.ace69dc5.js"><link rel="prefetch" href="/assets/js/388.d893882a.js"><link rel="prefetch" href="/assets/js/389.aafb666a.js"><link rel="prefetch" href="/assets/js/39.dc23f227.js"><link rel="prefetch" href="/assets/js/390.cd46ce9a.js"><link rel="prefetch" href="/assets/js/391.2489bf4d.js"><link rel="prefetch" href="/assets/js/392.bd808d7d.js"><link rel="prefetch" href="/assets/js/393.0cc724b3.js"><link rel="prefetch" href="/assets/js/394.a1fa5317.js"><link rel="prefetch" href="/assets/js/395.1bfcc41b.js"><link rel="prefetch" href="/assets/js/396.cea85523.js"><link rel="prefetch" href="/assets/js/397.bb804ca2.js"><link rel="prefetch" href="/assets/js/398.50565f7e.js"><link rel="prefetch" href="/assets/js/399.74479cbc.js"><link rel="prefetch" href="/assets/js/4.8a65540b.js"><link rel="prefetch" href="/assets/js/40.392e9cfa.js"><link rel="prefetch" href="/assets/js/400.1198cd7f.js"><link rel="prefetch" href="/assets/js/401.a28d6d8e.js"><link rel="prefetch" href="/assets/js/402.fc440624.js"><link rel="prefetch" href="/assets/js/403.41a56a7d.js"><link rel="prefetch" href="/assets/js/404.1c16f240.js"><link rel="prefetch" href="/assets/js/405.1b8fce59.js"><link rel="prefetch" href="/assets/js/406.1ddb8561.js"><link rel="prefetch" href="/assets/js/407.88814d26.js"><link rel="prefetch" href="/assets/js/408.6e4ec5c1.js"><link rel="prefetch" href="/assets/js/409.2de3d08b.js"><link rel="prefetch" href="/assets/js/41.e3799a68.js"><link rel="prefetch" href="/assets/js/410.58a086f2.js"><link rel="prefetch" href="/assets/js/411.55414f72.js"><link rel="prefetch" href="/assets/js/412.616281b7.js"><link rel="prefetch" href="/assets/js/413.8d0b92ce.js"><link rel="prefetch" href="/assets/js/414.48502543.js"><link rel="prefetch" href="/assets/js/415.dd029807.js"><link rel="prefetch" href="/assets/js/416.a85c8059.js"><link rel="prefetch" href="/assets/js/417.6b72be8b.js"><link rel="prefetch" href="/assets/js/418.898b5834.js"><link rel="prefetch" href="/assets/js/419.9819d311.js"><link rel="prefetch" href="/assets/js/42.c9cb25b9.js"><link rel="prefetch" href="/assets/js/420.ade3d9a2.js"><link rel="prefetch" href="/assets/js/421.32fde392.js"><link rel="prefetch" href="/assets/js/422.ef394a01.js"><link rel="prefetch" href="/assets/js/423.0cbd2a0f.js"><link rel="prefetch" href="/assets/js/424.3cfa4680.js"><link rel="prefetch" href="/assets/js/43.a98d6827.js"><link rel="prefetch" href="/assets/js/44.14694cf8.js"><link rel="prefetch" href="/assets/js/45.dca804e7.js"><link rel="prefetch" href="/assets/js/46.080381e7.js"><link rel="prefetch" href="/assets/js/47.83031369.js"><link rel="prefetch" href="/assets/js/48.dee67ad5.js"><link rel="prefetch" href="/assets/js/49.78bb2987.js"><link rel="prefetch" href="/assets/js/5.d7fa0851.js"><link rel="prefetch" href="/assets/js/50.f2bc56cc.js"><link rel="prefetch" href="/assets/js/51.8730c03d.js"><link rel="prefetch" href="/assets/js/52.0d4f2a08.js"><link rel="prefetch" href="/assets/js/53.9b683313.js"><link rel="prefetch" href="/assets/js/54.b57fb58c.js"><link rel="prefetch" href="/assets/js/55.0d469cc3.js"><link rel="prefetch" href="/assets/js/56.26cfc581.js"><link rel="prefetch" href="/assets/js/57.b4936910.js"><link rel="prefetch" href="/assets/js/58.1623297c.js"><link rel="prefetch" href="/assets/js/59.df3e6f56.js"><link rel="prefetch" href="/assets/js/6.410240e2.js"><link rel="prefetch" href="/assets/js/60.7d9c6a0e.js"><link rel="prefetch" href="/assets/js/61.78eba5c0.js"><link rel="prefetch" href="/assets/js/62.9e691762.js"><link rel="prefetch" href="/assets/js/63.0d967898.js"><link rel="prefetch" href="/assets/js/64.e93e2d36.js"><link rel="prefetch" href="/assets/js/65.45e9672a.js"><link rel="prefetch" href="/assets/js/66.e48c8460.js"><link rel="prefetch" href="/assets/js/67.7d1af7df.js"><link rel="prefetch" href="/assets/js/68.e8152acd.js"><link rel="prefetch" href="/assets/js/7.9b3ce1d6.js"><link rel="prefetch" href="/assets/js/70.c1efd33c.js"><link rel="prefetch" href="/assets/js/71.48dd4fe7.js"><link rel="prefetch" href="/assets/js/72.27b42419.js"><link rel="prefetch" href="/assets/js/73.93dcab42.js"><link rel="prefetch" href="/assets/js/74.e2019a37.js"><link rel="prefetch" href="/assets/js/75.60c56503.js"><link rel="prefetch" href="/assets/js/76.64c7d774.js"><link rel="prefetch" href="/assets/js/77.2b2028a6.js"><link rel="prefetch" href="/assets/js/78.9e4d5ab2.js"><link rel="prefetch" href="/assets/js/79.0c60b790.js"><link rel="prefetch" href="/assets/js/8.f29c542d.js"><link rel="prefetch" href="/assets/js/80.bd80ef15.js"><link rel="prefetch" href="/assets/js/81.5da7365f.js"><link rel="prefetch" href="/assets/js/82.cada287f.js"><link rel="prefetch" href="/assets/js/83.a113ec6b.js"><link rel="prefetch" href="/assets/js/84.49b242ef.js"><link rel="prefetch" href="/assets/js/85.8c1058d5.js"><link rel="prefetch" href="/assets/js/86.b141ba55.js"><link rel="prefetch" href="/assets/js/87.83d6216d.js"><link rel="prefetch" href="/assets/js/88.7b6a3796.js"><link rel="prefetch" href="/assets/js/89.746f8b85.js"><link rel="prefetch" href="/assets/js/9.1a6386bf.js"><link rel="prefetch" href="/assets/js/90.380a22d6.js"><link rel="prefetch" href="/assets/js/91.5bf1fb02.js"><link rel="prefetch" href="/assets/js/92.4da3b4ad.js"><link rel="prefetch" href="/assets/js/93.e46a9cd1.js"><link rel="prefetch" href="/assets/js/94.6305fa85.js"><link rel="prefetch" href="/assets/js/95.895cd992.js"><link rel="prefetch" href="/assets/js/96.a44204cb.js"><link rel="prefetch" href="/assets/js/97.7d9bf161.js"><link rel="prefetch" href="/assets/js/98.0fda6a7c.js"><link rel="prefetch" href="/assets/js/99.abdd813d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.09811c5e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">GitBlogs with Vue</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">OJ杂烩</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/gdut_yy/article/details/80045155" target="_blank" rel="noopener noreferrer" class="nav-link external">
  原 CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/module_oj/JIANZHIOffer/" class="nav-link">剑指 Offer</a></li><li class="dropdown-item"><!----> <a href="/module_oj/BIANCHENGZHIMEI/" class="nav-link">编程之美</a></li><li class="dropdown-item"><!----> <a href="/module_oj/GAOJISHUJUJIEGOU/" class="nav-link">高级数据结构</a></li><li class="dropdown-item"><!----> <a href="/module_oj/HW-OJ/" class="nav-link">HW-OJ</a></li><li class="dropdown-item"><!----> <a href="https://leetcode-cn.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LeetCode
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.nowcoder.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  牛客网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">阅读</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>阅读</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/module_book/tech/" class="nav-link">技术书籍</a></li><li class="dropdown-subitem"><a href="/module_book/tech-extra/" class="nav-link">泛技术书籍</a></li><li class="dropdown-subitem"><a href="/module_book/edu/" class="nav-link">校选教材</a></li><li class="dropdown-subitem"><a href="/module_book/literature/" class="nav-link">文学 &amp; 小说</a></li></ul></li><li class="dropdown-item"><h4>CSS（建设中）</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/gdut-yy/CSS-The-Definitive-Guide-4th-zh" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSS 权威指南 4th（Github）
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://gdut_yy.gitee.io/gitee-page/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSS 权威指南 4th（Preview）
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/module_book/JS/up&amp;going/" class="nav-link">YDKJS-起步上路</a></li><li class="dropdown-subitem"><a href="/module_book/JS/scope&amp;closures/" class="nav-link">YDKJS-作用域与闭包</a></li><li class="dropdown-subitem"><a href="/module_book/JS/this&amp;objectprototypes/" class="nav-link">YDKJS-this与对象原型</a></li><li class="dropdown-subitem"><a href="/module_book/JS/types&amp;grammar/" class="nav-link">YDKJS-类型与文法</a></li><li class="dropdown-subitem"><a href="/module_book/JS/async&amp;performance/" class="nav-link router-link-active">YDKJS-异步与性能</a></li><li class="dropdown-subitem"><a href="/module_book/JS/es6&amp;beyond/" class="nav-link">YDKJS-ES6与未来</a></li><li class="dropdown-subitem"><a href="/module_book/JS/Functional-Light-JS-zh/" class="nav-link">轻量函数式 JavaScript</a></li></ul></li><li class="dropdown-item"><h4>TODO</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/module_book/todo/" class="nav-link">10 本书</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">观影</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/module_movie/movie/" class="nav-link">电影</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Wiki</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/module_wiki/frontend/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/module_wiki/backend/" class="nav-link">后端</a></li><li class="dropdown-item"><!----> <a href="/module_wiki/android/" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/module_wiki/devops/" class="nav-link">DevOps</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/module_blog/year-end-summary/" class="nav-link">年终总结</a></li><li class="dropdown-item"><!----> <a href="/module_blog/learn-source/" class="nav-link">源码学习</a></li></ul></div></div> <a href="https://github.com/gdut-yy/GitBlogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">OJ杂烩</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/gdut_yy/article/details/80045155" target="_blank" rel="noopener noreferrer" class="nav-link external">
  原 CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/module_oj/JIANZHIOffer/" class="nav-link">剑指 Offer</a></li><li class="dropdown-item"><!----> <a href="/module_oj/BIANCHENGZHIMEI/" class="nav-link">编程之美</a></li><li class="dropdown-item"><!----> <a href="/module_oj/GAOJISHUJUJIEGOU/" class="nav-link">高级数据结构</a></li><li class="dropdown-item"><!----> <a href="/module_oj/HW-OJ/" class="nav-link">HW-OJ</a></li><li class="dropdown-item"><!----> <a href="https://leetcode-cn.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LeetCode
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.nowcoder.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  牛客网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">阅读</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>阅读</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/module_book/tech/" class="nav-link">技术书籍</a></li><li class="dropdown-subitem"><a href="/module_book/tech-extra/" class="nav-link">泛技术书籍</a></li><li class="dropdown-subitem"><a href="/module_book/edu/" class="nav-link">校选教材</a></li><li class="dropdown-subitem"><a href="/module_book/literature/" class="nav-link">文学 &amp; 小说</a></li></ul></li><li class="dropdown-item"><h4>CSS（建设中）</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/gdut-yy/CSS-The-Definitive-Guide-4th-zh" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSS 权威指南 4th（Github）
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://gdut_yy.gitee.io/gitee-page/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSS 权威指南 4th（Preview）
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/module_book/JS/up&amp;going/" class="nav-link">YDKJS-起步上路</a></li><li class="dropdown-subitem"><a href="/module_book/JS/scope&amp;closures/" class="nav-link">YDKJS-作用域与闭包</a></li><li class="dropdown-subitem"><a href="/module_book/JS/this&amp;objectprototypes/" class="nav-link">YDKJS-this与对象原型</a></li><li class="dropdown-subitem"><a href="/module_book/JS/types&amp;grammar/" class="nav-link">YDKJS-类型与文法</a></li><li class="dropdown-subitem"><a href="/module_book/JS/async&amp;performance/" class="nav-link router-link-active">YDKJS-异步与性能</a></li><li class="dropdown-subitem"><a href="/module_book/JS/es6&amp;beyond/" class="nav-link">YDKJS-ES6与未来</a></li><li class="dropdown-subitem"><a href="/module_book/JS/Functional-Light-JS-zh/" class="nav-link">轻量函数式 JavaScript</a></li></ul></li><li class="dropdown-item"><h4>TODO</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/module_book/todo/" class="nav-link">10 本书</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">观影</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/module_movie/movie/" class="nav-link">电影</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Wiki</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/module_wiki/frontend/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/module_wiki/backend/" class="nav-link">后端</a></li><li class="dropdown-item"><!----> <a href="/module_wiki/android/" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/module_wiki/devops/" class="nav-link">DevOps</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/module_blog/year-end-summary/" class="nav-link">年终总结</a></li><li class="dropdown-item"><!----> <a href="/module_blog/learn-source/" class="nav-link">源码学习</a></li></ul></div></div> <a href="https://github.com/gdut-yy/GitBlogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/module_book/JS/async&amp;performance/" class="sidebar-link">你不懂JS: 异步与性能</a></li><li><a href="/module_book/JS/async&amp;performance/foreword.html" class="sidebar-link">序</a></li><li><a href="/module_book/JS/async&amp;performance/ch1.html" class="sidebar-link">第一章: 异步: 现在与稍后</a></li><li><a href="/module_book/JS/async&amp;performance/ch2.html" class="sidebar-link">第二章: 回调</a></li><li><a href="/module_book/JS/async&amp;performance/ch3.html" class="sidebar-link">第三章: Promises</a></li><li><a href="/module_book/JS/async&amp;performance/ch4.html" class="sidebar-link">第四章: Generator</a></li><li><a href="/module_book/JS/async&amp;performance/ch5.html" class="sidebar-link">第五章: 程序性能</a></li><li><a href="/module_book/JS/async&amp;performance/ch6.html" class="sidebar-link">第六章: 基准分析与调优</a></li><li><a href="/module_book/JS/async&amp;performance/apA.html" class="active sidebar-link">附录A: asynquence 库</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#序列，抽象设计" class="sidebar-link">序列，抽象设计</a></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#asynquence-api" class="sidebar-link">asynquence API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#步骤" class="sidebar-link">步骤</a></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#错误" class="sidebar-link">错误</a></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#并行步骤" class="sidebar-link">并行步骤</a></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#序列分支" class="sidebar-link">序列分支</a></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#组合序列" class="sidebar-link">组合序列</a></li></ul></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#值与错误序列" class="sidebar-link">值与错误序列</a></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#promises-与回调" class="sidebar-link">Promises 与回调</a></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#可迭代序列" class="sidebar-link">可迭代序列</a></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#运行-generator" class="sidebar-link">运行 Generator</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#包装过的-generator" class="sidebar-link">包装过的 Generator</a></li></ul></li><li class="sidebar-sub-header"><a href="/module_book/JS/async&amp;performance/apA.html#复习" class="sidebar-link">复习</a></li></ul></li><li><a href="/module_book/JS/async&amp;performance/apB.html" class="sidebar-link">附录B: 高级异步模式</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="附录a-asynquence-库"><a href="#附录a-asynquence-库" aria-hidden="true" class="header-anchor">#</a> 附录A: <em>asynquence</em> 库</h1> <p>第一章和第二章相当详细地探讨了常见的异步编程模式，以及如何通过回调解决它们。但我们也看到了为什么回调在处理能力上有着致命的缺陷，这将我们带到了第三章和第四章，Promise 与 Generator 为你的异步流程构建提供了一个更加坚实，可信，以及可推理的基础。</p> <p>我在这本书中好几次提到我自己的异步库 <em>asynquence</em> (http://github.com/getify/asynquence) —— “async” + “sequence” = “asynquence”，现在我想简要讲解一下它的工作原理，以及它的独特设计为什么很重要和很有用。</p> <p>在下一篇附录中，我们将要探索一些高级的异步模式，但为了它们的可用性能够使人接受你可能需要一个库。我们将使用 <em>asynquence</em> 来表达这些模式，所以你会想首先在这里花一点时间来了解这个库。</p> <p><em>asynquence</em> 绝对不是优秀异步编码的唯一选择；在这方面当然有许多了不起的库。但是 <em>asynquence</em> 提供了一种独特的视角 —— 通过将这些模式中最好的部分组合进一个单独的库，另外它基于一个基本的抽象：（异步）序列。</p> <p>我的前提是，精巧的JS程序经常或多或少地需要将各种不同的异步模式交织在一起，而且这通常是完全依靠每个开发者自己去搞清楚的。与其引入关注于异步流程的不同方面的两个或更多的库，<em>asynquence</em> 将它们统一为各种序列步骤，成为单独一个需要学习和部署的核心库。</p> <p>我相信 <em>asynquence</em> 有足够高的价值可以使 Promise 风格的异步流程控制编程变得超级容易完成，这就是我们为什么会在这里单单关注这个库。</p> <p>开始之前，我将讲解 <em>asynquence</em> 背后的设计原则，然后我们将使用代码示例来展示它的API如何工作。</p> <h2 id="序列，抽象设计"><a href="#序列，抽象设计" aria-hidden="true" class="header-anchor">#</a> 序列，抽象设计</h2> <p>对 <em>asynquence</em> 的理解开始于对一个基础抽象的理解：对于一个任务的任何一系列步骤来说，无论它们是同步的还是异步的，都可以被综合地考虑为一个“序列（sequence）”。换句话说，一个序列是一个容器，它代表一个任务，并由一个个完成这个任务的独立的（可能是异步的）步骤组成。</p> <p>在这个序列中的每一个步骤都处于一个 Promise（见第三章） 的控制之下。也就是你向一个序列添加的每一个步骤都隐含地创建了一个 Promise，它被链接到这个序列的末尾。由于 Promise 的语义，在一个序列中的每一个步骤的推进都是异步的，即使你同步地完成这个步骤。</p> <p>另外，一个序列将总是一步一步线性地进行，也就是步骤2总是发生在步骤1完成之后，如此类推。</p> <p>当然，一个新的序列可以从既存的序列中分支出来，也就是分支仅在主序列在流程中到达那一点时发生。序列还可以用各种方式组合，包括使一个序列在流程中的一个特定的位置汇合另一个序列。</p> <p>一个序列与 Promise 链有些相像。但是，在 Promise 链中，不存在一个可以引用整个链条的“把手”可以抓住。不管你持有哪一个 Promise 的引用，它都表示链条中当前的步骤外加挂载在它后面的其他步骤。实质上，你无法持有一个 Promise 链条的引用，除非你持有链条中第一个 Promise 的引用。</p> <p>许多情况表明，持有一个综合地指向整个序列的引用是十分有用的。这些情况中最重要的一种就是序列的退出/取消。正如我们在第三章中展开谈过的那样，Promise 本身绝不应当是可以取消的，因为这违反了一个基本设计规则：外部不可变性。</p> <p>但是序列没有这样的不可变性设计原则，这主要是由于序列不会作为需要不可变语义的未来值的容器被传递。所以序列是一个处理退出/取消行为的恰当的抽象层面。<em>asynquence</em> 序列可以在任何时候<code>abort()</code>，而且这个序列将会停止在那一点而不会因为任何原因继续下去。</p> <p>为了流程控制，还有许多理由首选序列的抽象而非 Promise 链。</p> <p>首先，Promise 链是一个更加手动的处理 —— 一旦你开始在你的程序中大面积地创建和链接 Promise ，这种处理可能会变得相当烦冗 —— 在那些使用 Promise 相当恰当的地方，这种烦冗会降低效率而使得开发者不愿使用Promise。</p> <p>抽象意味着减少模板代码和烦冗，所以序列抽象是这个问题的一个好的解决方案。使用 Promise，你关注的是个别的步骤，而且不太会假定你将延续这个链条。而序列采用相反的方式，它假定序列将会无限地持续添加更多步骤。</p> <p>当你开始考虑更高阶的 Promise 模式时（除了<code>race([..])</code>和<code>all([..])</code>以外），这种抽象复杂性的降低特别强大。</p> <p>例如，在一个序列的中间，你可能想表达一个在概念上类似于<code>try..catch</code>的步骤，它的结果将总是成功，不管是意料之中的主线上的成功解析，还是为被捕获的错误提供一个正面的非错误信号。或者，你可能想表达一个类似于 retry/until 循环的步骤，它不停地尝试相同的步骤直到成功为止。</p> <p>仅仅使用基本的 Promise，这类抽象不是很容易表达，而且在一个既存的 Promise 链的中间这样做不好看。但如果你将你的想法抽象为一个序列，并将一个步骤考虑为一个 Promise 的包装，这个包装可以隐藏这样的细节，它就可以使你以最合理的方式考虑流程控制，而不必关心细节。</p> <p>第二，也许是更重要的，将异步流程控制考虑为一个序列中的步骤，允许你将这样的细节抽象出去 —— 每一个步骤中引入了哪一种异步性。在这种抽象之下，一个 Promise 将总是控制着步骤，但在抽象之上，这个步骤可以看起来像一个延续回调（简单的默认值），或者一个真正的 Promise，或者一个运行至完成的 Generator，或者... 希望你明白我的意思。</p> <p>第三，序列可以通容易地被调整来适应于不同的思考模式，比如基于事件的，基于流的，或者基于相应式的编码。<em>asynquence</em> 提供了一种我称为“响应式序列”的模式（我们稍后讲解），它是 RxJS（“Reactive Extensions”） 中“响应式可监听”思想的变种，允许重复的事件每次触发一个新的序列实例。Promise 是一次性的，所以单独使用 Promise 来表达重复的异步性十分尴尬。</p> <p>在一种我称为“可迭代序列”的模式中，另一种思考模式反转了解析/控制能力。与每一个步骤在内部控制它自己的完成（并因此推进这个序列）不同，序列被反转为通过一个外部迭代器来进行推进控制，而且在这个 <em>可迭代序列</em> 中的每一步仅仅应答<code>next(..)</code><em>迭代器</em> 控制。</p> <p>在本附录的剩余部分，我们将探索所有这些不同的种类，所以如果我们刚才的步伐太快也不要担心。</p> <p>要点是，对于复杂的异步处理来说，序列是一个要比单纯的 Promise（Promise链）或单纯的 Generator 更加强大与合理的抽象，而 <em>asynquence</em> 被设计为使用恰当层面的语法糖来表达这种抽象，使得异步编程变得更加易于理解和更加令人愉快。</p> <h2 id="asynquence-api"><a href="#asynquence-api" aria-hidden="true" class="header-anchor">#</a> <em>asynquence</em> API</h2> <p>首先，你创建一个序列（一个 <em>asynquence</em> 实例）的方法是使用<code>ASQ(..)</code>函数。一个不带参数的<code>ASQ()</code>调用会创建一个空的初始序列，而向<code>ASQ(..)</code>传递一个或多个值或函数的话，它会使用每个参数值代表序列的初始步骤来创建序列。</p> <p><strong>注意：</strong> 为了这里所有的代码示例，我将使用 <em>asynquence</em> 在浏览器全局作用域中的顶层标识符：<code>ASQ</code>。如果你通过一个模块系统（在浏览器或服务器中）引入并使用 <em>asynquence</em>，你当然可以定义自己喜欢的符号，<em>asynquence</em> 不会关心这些！</p> <p>许多在这里讨论的API方法都内建于 <em>asynquence</em> 的核心部分，而其他的API是通过引入可选的“contrib”插件包提供的。要知道一个方法是内建的还是通过插件定义的，可以参见 <em>asynquence</em> 的文档：http://github.com/getify/asynquence</p> <h3 id="步骤"><a href="#步骤" aria-hidden="true" class="header-anchor">#</a> 步骤</h3> <p>如果一个函数代表序列中的一个普通步骤，那么这个函数会被这样调用：第一个参数是延续回调，而任何后续参数都是从前一个步骤中传递下来的消息。在延续回调被调用之前，这个步骤将不会完成。一旦延续回调被调用，你传递给它的任何参数值都会作为序列下一个步骤中的消息被发送。</p> <p>要向一个序列添加额外的普通步骤，调用<code>then(..)</code>（它实质上与<code>ASQ(..)</code>调用的语义完全相同）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">ASQ</span><span class="token punctuation">(</span>
	<span class="token comment">// 步骤 1</span>
	<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">done</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 步骤 2</span>
	<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done<span class="token punctuation">,</span>greeting</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">done</span><span class="token punctuation">(</span> greeting <span class="token operator">+</span> <span class="token string">&quot; World&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment">// 步骤 3</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done<span class="token punctuation">,</span>msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span> msg<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// 步骤 4</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done<span class="token punctuation">,</span>msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// HELLO WORLD</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>注意：</strong> 虽然<code>then(..)</code>这个名称与原生的 Promise API 完全一样，但是这个<code>then(..)</code>的含义是不同的。你可以传递任意多或者任意少的函数或值给<code>then(..)</code>，而它们中的每一个都被看作是一个分离的步骤。这里与完成/拒绝语义的双回调毫不相干。</p> <p>在 Promise 中，可以把一个 Promise 与下一个你在<code>then(..)</code>的完成处理器中创建并<code>return</code>的 Promise 链接。与此不同的是，在 <em>asynquence</em> 中，你所需要做的一切就是调用延续回调 —— 我总是称之为<code>done()</code>，但你可以起任何适合你的名字 —— 并将完成的消息作为参数值选择性地传递给它。</p> <p>通过<code>then(..)</code>定义的每一个步骤都被认为是异步的。如果你有一个同步的步骤，你可以立即调用<code>done(..)</code>，或者使用更简单的<code>val(..)</code>步骤帮助函数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 步骤 1（同步）</span>
<span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">done</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 手动同步</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// 步骤 2（同步）</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">greeting</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> greeting <span class="token operator">+</span> <span class="token string">&quot; World&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// 步骤 3（异步）</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done<span class="token punctuation">,</span>msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span> msg<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// 步骤 4（同步）</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如你所见，<code>val(..)</code>调用的步骤不会收到一个延续回调，因为这部分已经为你做好了 —— 而且参数列表作为一个结果显得不那么凌乱了！要向下一个步骤发送消息，你简单地使用<code>return</code>。</p> <p>将<code>val(..)</code>考虑为表示一个同步的“仅含有值”的步骤，它对同步的值操作，比如 logging 之类，非常有用。</p> <h3 id="错误"><a href="#错误" aria-hidden="true" class="header-anchor">#</a> 错误</h3> <p>与 Promise 相比 <em>asynquence</em> 的一个重要的不同之处是错误处理。</p> <p>在 Promise 链条中，每个 Promise（步骤）都可以拥有自己独立的错误，而每个后续的步骤都有能力处理或不处理这个错误。这种语义（再一次）主要来自于对每个单独的 Promise 的关注，而非对整个链条（序列）的关注。</p> <p>我相信，在大多数情况下，一个位于序列中某一部分的错误通常是不可恢复的，所以序列中后续的步骤毫无意义而应当被跳过。所以，默认情况下，在一个序列的任意一个步骤中的错误会将整个序列置于错误模式，而剩下的普通步骤将会被忽略。</p> <p>如果你 <em>确实</em> 需要一个错误可以被恢复的步骤，有几个不同的API可以适应这种情况，比如<code>try(..)</code> —— 先前提到过的，有些像<code>try..catch</code>的步骤 —— 或者<code>until(..)</code> —— 一个重试循环，它持续地尝试一个步骤直到它成功或你手动地<code>break()</code>这个循环。<em>asynquence</em> 甚至拥有<code>pThen(..)</code>和<code>pCatch(..)</code>方法，它们的工作方式与普通的 Promise 的<code>then(..)</code>和<code>catch(..)</code>（见第三章）完全相同，所以如果你选择这么做，你就可以进行本地化的序列中错误处理。</p> <p>重点是，你同时拥有两个选项，但是在我的经验中更常见的是默认情况。使用 Promise，要使一个步骤的链条在错误发生时一次性忽略所有步骤，你不得不小心不要在任何步骤中注册拒绝处理器；否则，这个错误会被视为处理过而被吞掉，而序列可能仍会继续下去（也许不是意料之中的）。要恰当且可靠地处理这种期待的行为有点儿尴尬。</p> <p>要注册一个序列错误通知处理器，<em>asynquence</em> 提供了一个<code>or(..)</code>序列方法，它还有一个别名叫做<code>onerror(..)</code>。你可以在序列的任何位置调用这个方法，而且你可以注册任意多的处理器。这使得让多个不同的消费者监听一个序列是否失败变得很容易；从这个角度讲，它有点儿像一个错误事件处理器。</p> <p>正如使用 Promise 那样，所有JS异常都会变为序列错误，或者你可以通过编程来发生一个序列错误：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 为序列发出一个错误</span>
		done<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span> <span class="token string">&quot;Oops&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 永远不会到达这里</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> err <span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// Oops</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 也不会到达这里</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 稍后</span>

sq<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> err <span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// Oops</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><em>asynquence</em> 与原生的 Promise 相比，在错误处理上另一个重要的不同就是“未处理异常”的默认行为。正如我们在第三章中以相当的篇幅讨论过的，一个没有被注册拒绝处理器的 Promise 如果被拒绝的话，将会无声地保持（也就是吞掉）那个错误；你不得不总是想着要用一个最后的<code>catch(..)</code>来终结一个链条。</p> <p>在 <em>asynquence</em> 中，这种假设被颠倒过来了。</p> <p>如果一个错误在序列上发生，而且 <strong>在那个时刻</strong> 它没有被注册错误处理器，那么这个错误会被报告至<code>console</code>。换言之，未处理的的拒绝将总是默认地被报告，因此不会被吞掉或丢掉。</p> <p>为了防止重复的噪音，只要你向一个序列注册一个错误处理器，它就会使这个序列从这样的报告中退出。</p> <p>事实上有许多情况你想要创建这样一个序列，它可能会在你有机会注册处理器之前就进入错误状态。这不常见，但可能时不时地发生。</p> <p>在这样的情况下，你也可以通过在序列上调用<code>defer()</code>来使一个序列实例 <strong>从错误报告中退出</strong>。你应当仅在自己确信不会最终处理这样的错误时，才决定从报告中退出：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq1 <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	doesnt<span class="token punctuation">.</span><span class="token function">Exist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 将会向控制台抛出异常</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> sq2 <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	doesnt<span class="token punctuation">.</span><span class="token function">Exist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 仅仅会抛出一个序列错误</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// 错误报告中的退出</span>
<span class="token punctuation">.</span><span class="token function">defer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	sq1<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> err <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// ReferenceError</span>
	<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

	sq2<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> err <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// ReferenceError</span>
	<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ReferenceError （来自sq1）</span>
</code></pre></div><p>这是一种比 Promise 本身拥有的更好的错误处理行为，因为它是一个成功的深渊，而不是一个失败的深渊（参见第三章）。</p> <p><strong>注意：</strong> 如果一个序列被导入（也就是被汇合入）另一个序列 —— 完整的描述参见“组合序列” —— 之后源序列从错误报告中退出，那么就必须考虑目标序列是否进行错误报告。</p> <h3 id="并行步骤"><a href="#并行步骤" aria-hidden="true" class="header-anchor">#</a> 并行步骤</h3> <p>在你的序列中不是所有的步骤都将只拥有一个（异步）任务去执行；有些将会需要“并行”（并发地）执行多个步骤。在一个序列中，一个并发地处理多个子步骤的步骤称为一个<code>gate(..)</code> —— 如果你喜欢的话它还有一个别名<code>all(..)</code> —— 而且它与原生的<code>Promise.all([..])</code>是对称的。</p> <p>如果在<code>gate(..)</code>中的所有步骤都成功地完成了，那么所有成功的消息都将被传递到下一个序列步骤中。如果它们中的任何一个产生了一个错误，那么整个序列会立即进入错误状态。</p> <p>考虑如下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> done<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">gate</span><span class="token punctuation">(</span>
	<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">done</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">done</span><span class="token punctuation">(</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;!&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg1<span class="token punctuation">,</span>msg2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg1 <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// Hello</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg2 <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// [ &quot;World&quot;, &quot;!&quot; ]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>为了展示差异，让我们把这个例子与原生 Promise 比较一下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> resolve<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token function">resolve</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">// 注意：这里我们需要一个 [ ]</span>
				<span class="token function">resolve</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;!&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token punctuation">)</span>
	<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msgs</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// Hello</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msgs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// [ &quot;World&quot;, &quot;!&quot; ]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>讨厌。Promise 需要多得多的模板代码来表达相同的异步流程控制。这个例子很好地说明了为什么 <em>asynquence</em> API 和抽象使得对付 Promise 步骤容易多了。你的异步流程越复杂，它的改进程度就越高。</p> <h4 id="各种步骤"><a href="#各种步骤" aria-hidden="true" class="header-anchor">#</a> 各种步骤</h4> <p>关于 <em>asynquence</em> 的<code>gate(..)</code>步骤类型，有好几种不同的 contrib 插件可能十分有用：</p> <ul><li><code>any(..)</code>很像<code>gate(..)</code>，除了为了继续主序列，只需要有一个环节最终必须成功。</li> <li><code>first(..)</code>很像<code>any(..)</code>，除了只要有任何一个环节成功，主序列就会继续（忽略任何其余环节产生的后续结果）。</li> <li><code>race(..)</code>（与<code>Promise.race([..])</code>对称）很像<code>first(..)</code>，除了主序列会在任何环节完成时（不管成功还是失败）立即继续。</li> <li><code>last(..)</code>很像<code>any(..)</code>，除了只有最后一个环节成功完成时才会把它的消息发送给主序列。</li> <li><code>none(..)</code>是<code>gate(..)</code>的反义：主序列仅在所有环节失败时才会继续（将所有环节的错误消息作为成功消息传送，或者反之）。</li></ul> <p>让我们首先定义一些帮助函数来使示例清晰一些：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">success1</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">success2</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">failure3</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		done<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">output</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在，让我们展示一些这些<code>gate(..)</code>步骤的变种：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span>
	failure3<span class="token punctuation">,</span>
	success1
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 3</span>


<span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span>
	success1<span class="token punctuation">,</span>
	failure3<span class="token punctuation">,</span>
	success2
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> arguments <span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
		args		<span class="token comment">// [ 1, undefined, 2 ]</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span>
	failure3<span class="token punctuation">,</span>
	success1<span class="token punctuation">,</span>
	success2
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 1</span>


<span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span>
	failure3<span class="token punctuation">,</span>
	success1<span class="token punctuation">,</span>
	success2
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 2</span>

<span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">none</span><span class="token punctuation">(</span>
	failure3
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span>		<span class="token comment">// 3</span>
<span class="token punctuation">.</span><span class="token function">none</span><span class="token punctuation">(</span>
	failure3
	success1
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 1</span>
</code></pre></div><p>另一个步骤种类是<code>map(..)</code>，它让你将一个数组的元素异步地映射为不同的值，而且在所有映射完成之前步骤不会前进。<code>map(..)</code>与<code>gate(..)</code>十分相似，除了它从一个数组，而非从一个指定的分离函数那里得到初始值，而且你定义一个函数回调来操作每一个值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span> x <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> double <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">// [2,4,6]</span>
</code></pre></div><p>另外，<code>map(..)</code>可以从前一步骤传递来的消息中收到它的两个参数（数组或者回调）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">plusOne</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span> x <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span> double <span class="token punctuation">)</span>			<span class="token comment">// 收到消息`[1,2,3]`</span>
<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span> plusOne <span class="token punctuation">)</span>			<span class="token comment">// 收到消息`[2,4,6]`</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// [3,5,7]</span>
</code></pre></div><p>另一个种类是<code>waterfall(..)</code>，它有些像混合了<code>gate(..)</code>的消息收集行为与<code>then(..)</code>的序列化处理。</p> <p>步骤1首先被执行，然后来自步骤1的成功消息被传递给步骤2，然后两个成功消息走到步骤3，然后所有三个成功消息走到步骤4，如此继续，这样消息被某种程度上收集并从“瀑布”上倾泻而下。</p> <p>考虑如下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> arguments<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> args <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span> args<span class="token punctuation">[</span>args<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token number">3</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">waterfall</span><span class="token punctuation">(</span>
	double<span class="token punctuation">,</span>					<span class="token comment">// [ 3 ]</span>
	double<span class="token punctuation">,</span>					<span class="token comment">// [ 6 ]</span>
	double<span class="token punctuation">,</span>					<span class="token comment">// [ 6, 12 ]</span>
	double					<span class="token comment">// [ 6, 12, 24 ]</span>
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> arguments <span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> args <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// [ 6, 12, 24, 48 ]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果在“瀑布”的任何一点发生错误，那么整个序列就会立即进入错误状态。</p> <h4 id="容错"><a href="#容错" aria-hidden="true" class="header-anchor">#</a> 容错</h4> <p>有时你想在步骤一级管理错误，而不一定让它们使整个序列成为错误状态。<em>asynquence</em> 为此提供了两种步骤类型。</p> <p><code>try(..)</code>尝试一个步骤，如果它成功，序列就会正常继续，但如果这个步骤失败了，失败的状态会转换成格式为<code>{ catch: .. }</code>的成功消息，它的值由错误消息填充：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">try</span><span class="token punctuation">(</span> success1 <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span>			<span class="token comment">// 1</span>
<span class="token punctuation">.</span><span class="token function">try</span><span class="token punctuation">(</span> failure3 <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span>			<span class="token comment">// { catch: 3 }</span>
<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 永远不会到达这里</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你还可以使用<code>until(..)</code>构建一个重试循环，它尝试一个步骤，如果失败，就会在下一个事件轮询的 tick 中重试这个步骤，如此继续。</p> <p>这种重试循环可以无限延续下去，但如果你想要从循环中跳出来，你可以在完成触发器上调用<code>break()</code>标志方法，它将主序列置为错误状态：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token number">3</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span> double <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span>					<span class="token comment">// 6</span>
<span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	count<span class="token operator">++</span><span class="token punctuation">;</span>

	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			done<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// 跳出 `until(..)` 重试循环</span>
			done<span class="token punctuation">.</span><span class="token function">break</span><span class="token punctuation">(</span> <span class="token string">&quot;Oops&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">// Oops</span>
</code></pre></div><h4 id="promise-式的步骤"><a href="#promise-式的步骤" aria-hidden="true" class="header-anchor">#</a> Promise 式的步骤</h4> <p>如果你喜欢在你的序列中内联 Promise 风格的语义，比如 Promise 的<code>then(..)</code>和<code>catch(..)</code>（见第三章），你可以使用<code>pThen</code>和<code>pCatch</code>插件：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token number">21</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">pThen</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> msg <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">pThen</span><span class="token punctuation">(</span> output <span class="token punctuation">)</span>				<span class="token comment">// 42</span>
<span class="token punctuation">.</span><span class="token function">pThen</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 抛出一个异常</span>
	doesnt<span class="token punctuation">.</span><span class="token function">Exist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">pCatch</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 捕获这个异常（拒绝）</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> err <span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// ReferenceError</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 主旋律回归到正常状态，</span>
	<span class="token comment">// 因为前一个异常已经被</span>
	<span class="token comment">// `pCatch(..)`捕获了</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>pThen(..)</code>和<code>pCatch(..)</code>被设计为运行在序列中，但好像在普通的 Promise 链中动作。这样，你就可以在传递给<code>pThen(..)</code>的“完成”处理器中解析纯粹的 Promise 或者 <em>asynquence</em> 序列。</p> <h3 id="序列分支"><a href="#序列分支" aria-hidden="true" class="header-anchor">#</a> 序列分支</h3> <p>一个有关 Promise 的可能十分有用的特性是，你可以在同一个 Promise 上添附多个<code>then(..)</code>处理器，这实质上在这个 Promise 的流程上创建了“分支”：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span> <span class="token number">21</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// （从`p`开始的）分支 1</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> msg <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 42</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token comment">// （从`p`开始的）分支 2</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 21</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用 <em>asynquence</em> 的<code>fork()</code>可以很容易地进行同样的“分支”：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> sq2 <span class="token operator">=</span> sq<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 分支 1</span>
sq<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>

<span class="token comment">// 分支 2</span>
sq2<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="组合序列"><a href="#组合序列" aria-hidden="true" class="header-anchor">#</a> 组合序列</h3> <p>与<code>fork()</code>相反的是，你可以通过将一个序列汇合进另一个来组合两个序列，使用<code>seq(..)</code>实例方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello World&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span> done<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// 将序列 `sq` 汇合进这个系列</span>
<span class="token punctuation">.</span><span class="token function">seq</span><span class="token punctuation">(</span> sq <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// Hello World</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre></div><p><code>seq(..)</code>可以像这里展示的那样接收一个序列本身，或者接收一个函数。如果是一个函数，那么它会期待这个函数被调用时返回一个序列，所以前面的代码可以这样写：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ..</span>
<span class="token punctuation">.</span><span class="token function">seq</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> sq<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// ..</span>
</code></pre></div><p>另外，这个步骤还可以使用<code>pipe(..)</code>来完成：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ..</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 将 `sq` 导入延续回调 `done`</span>
	sq<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span> done <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// ..</span>
</code></pre></div><p>当一个序列被汇合时，它的成功消息流和错误消息流都会被导入。</p> <p><strong>注意：</strong> 正如早先的注意事项中提到过的，导入会使源序列从错误报告中退出，但不会影响目标序列的错误报告状态。</p> <h2 id="值与错误序列"><a href="#值与错误序列" aria-hidden="true" class="header-anchor">#</a> 值与错误序列</h2> <p>如果一个序列的任意一个步骤只是一个普通值，那么这个值就会被映射到这个步骤的完成消息中：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token number">42</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

sq<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 42</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果你想制造一个自动出错的序列：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">.</span><span class="token function">failed</span><span class="token punctuation">(</span> <span class="token string">&quot;Oops&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">seq</span><span class="token punctuation">(</span> sq <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 不会到达这里</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> err <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// Oops</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你还可能想要自动地创建一个延迟的值或者延迟的错误序列。使用<code>after</code>和<code>failAfter</code> contrib 插件，这很容易：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq1 <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;World&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sq2 <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">.</span><span class="token function">failAfter</span><span class="token punctuation">(</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&quot;Oops&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

sq1<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg1<span class="token punctuation">,</span>msg2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg1<span class="token punctuation">,</span> msg2 <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// Hello World</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

sq2<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> err <span class="token punctuation">)</span><span class="token punctuation">;</span>				<span class="token comment">// Oops</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你还可以使用<code>after'(..)</code>在一个序列的中间插入一个延迟：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token number">42</span> <span class="token punctuation">)</span>
<span class="token comment">// 在这个序列中插入一个延迟</span>
<span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span> <span class="token number">100</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 42</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="promises-与回调"><a href="#promises-与回调" aria-hidden="true" class="header-anchor">#</a> Promises 与回调</h2> <p>我认为 <em>asynquence</em> 序列在原生的 Promise 之上提供了许多价值，而且你会发现在很大程度上它在抽象层面上使用起来更舒适更强大。然而，将 <em>asynquence</em> 与其他非 <em>asynquence</em> 代码进行整合将是不可避免的现实。</p> <p>使用<code>promise(..)</code>实例方法，你可以很容易地将一个 Promise（也就是 thenable —— 见第三章）汇合进一个序列：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span> <span class="token number">42</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token constant">ASQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span> p <span class="token punctuation">)</span>			<span class="token comment">// 本可以写做：`function(){ return p; }`</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 42</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>要向相反的方向走，从一个序列的特定步骤中分支/出让一个 Promise，使用<code>toPromise</code> contrib 插件：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello World&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

sq<span class="token punctuation">.</span><span class="token function">toPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 现在这是一个标准的 promise 链了</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> msg<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// HELLO WORLD</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>有好几种帮助设施可以在使用回调的系统中适配 <em>asynquence</em>。要从你的序列中自动地生成一个“错误优先风格”回调，来接入一个面向回调的工具，使用<code>errfcb</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sq <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 注意：这里期待“错误优先风格”的回调</span>
	<span class="token function">someAsyncFuncWithCB</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> done<span class="token punctuation">.</span>errfcb <span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// ..</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// ..</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 注意：这里期待“错误优先风格”的回调</span>
<span class="token function">anotherAsyncFuncWithCB</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> sq<span class="token punctuation">.</span><span class="token function">errfcb</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你还可能想要创建一个工具的序列包装版本 —— 与第三章的“promisory”和第四章的“thunkory”相比较 —— <em>asynquence</em> 为此提供了<code>ASQ.wrap(..)</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> coolUtility <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span> someAsyncFuncWithCB <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">coolUtility</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// ..</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// ..</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>注意：</strong> 为了清晰（和有趣！），让我们为来自<code>ASQ.wrap(..)</code>的产生序列的函数杜撰另一个名词，就像这里的<code>coolUtility</code>。我提议“sequory”（“sequence” + “factory”）。</p> <h2 id="可迭代序列"><a href="#可迭代序列" aria-hidden="true" class="header-anchor">#</a> 可迭代序列</h2> <p>一个序列普通的范例是，每一个步骤都负责完成它自己，进而推进这个序列。Promise 就是这样工作的。</p> <p>不幸的是，有时你需要从外部控制一个 Promise/步骤，而这会导致尴尬的“能力抽取”。</p> <p>考虑这个 Promise 的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> domready <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 不想把这个放在这里，因为在逻辑上</span>
	<span class="token comment">// 它属于代码的另一部分</span>
	document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">&quot;DOMContentLoaded&quot;</span><span class="token punctuation">,</span> resolve <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ..</span>

domready<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// DOM 准备好了！</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>关于 Promise 的“能力抽取”范模式看起来像这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> ready<span class="token punctuation">;</span>

<span class="token keyword">var</span> domready <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 抽取 `resolve()` 能力</span>
	ready <span class="token operator">=</span> resolve<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ..</span>

domready<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// DOM 准备好了！</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ..</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">&quot;DOMContentLoaded&quot;</span><span class="token punctuation">,</span> ready <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>注意：</strong> 在我看来，这种反模式是一种尴尬的代码风格，但有些开发者喜欢，我不能理解其中的原因。</p> <p><em>asynquence</em> 提供一种我称为“可迭代序列”的反转序列类型，它将控制能力外部化（它在<code>domready</code>这样的情况下十分有用）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 注意：这里`domready`是一个控制序列的 *迭代器*</span>
<span class="token keyword">var</span> domready <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">.</span><span class="token function">iterable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ..</span>

domready<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// DOM 准备好了！</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ..</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">&quot;DOMContentLoaded&quot;</span><span class="token punctuation">,</span> domready<span class="token punctuation">.</span>next <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>与我们在这个场景中看到的东西比起来，可迭代序列还有很多内容。我们将在附录B中回过头来讨论它们。</p> <h2 id="运行-generator"><a href="#运行-generator" aria-hidden="true" class="header-anchor">#</a> 运行 Generator</h2> <p>在第四章中，我们衍生了一种称为<code>run(..)</code>的工具，它可以将 generator 运行至完成，监听被<code>yield</code>的 Promise 并使用它们来异步推进 generator。<em>asynquence</em> 正好有一个这样的内建工具，称为<code>runner(..)</code>。</p> <p>为了展示，让我们首先建立一些帮助函数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">doublePr</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">resolve</span><span class="token punctuation">(</span> x <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">doubleSeq</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">done</span><span class="token punctuation">(</span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在，我们可以在一个序列的中间使用<code>runner(..)</code>作为一个步骤：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">ASQ</span><span class="token punctuation">(</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">runner</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token operator">*</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token operator">=</span> token<span class="token punctuation">.</span>messages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> token<span class="token punctuation">.</span>messages<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">// yield 一个真正的 promise</span>
	x <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">doublePr</span><span class="token punctuation">(</span> x <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// yield 一个序列</span>
	x <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">doubleSeq</span><span class="token punctuation">(</span> x <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 84</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="包装过的-generator"><a href="#包装过的-generator" aria-hidden="true" class="header-anchor">#</a> 包装过的 Generator</h3> <p>你还可以创建自包装的 generator —— 也就是一个普通函数，运行你指定的 generator 并为它的完成返回一个序列 —— 通过<code>ASQ.wrap(..)</code>包装它：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token constant">ASQ</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token operator">*</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token operator">=</span> token<span class="token punctuation">.</span>messages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> token<span class="token punctuation">.</span>messages<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">// yield 一个真正的 promise</span>
	x <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">doublePr</span><span class="token punctuation">(</span> x <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// yield 一个序列</span>
	x <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">doubleSeq</span><span class="token punctuation">(</span> x <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> gen<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ..</span>

<span class="token function">foo</span><span class="token punctuation">(</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> msg <span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 68</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>runner(..)</code>还能做很多很牛的事情，我们会在附录B中回过头来讨论它。</p> <h2 id="复习"><a href="#复习" aria-hidden="true" class="header-anchor">#</a> 复习</h2> <p><em>asynquence</em> 是一个在 Promise 之上的简单抽象 —— 一个序列是一系列（异步）步骤，它的目标是使各种异步模式更加容易使用，而在功能上没有任何妥协。</p> <p>在 <em>asynquence</em> 的核心API与它的 contrib 插件中，除了我们在这篇附录中看到的内容以外还有其他的好东西，我们把对这些剩余功能的探索作为练习留给读者。</p> <p>现在你看到了 <em>asynquence</em> 的实质与精神。关键点是，一个序列由许多步骤组成，而这些步骤可以使许多不同种类的 Promise，或者它们可以是一个 generator 运行器，或者... 选择由你来决定，你有完全的自由为你的任务采用恰当的任何异步流程控制逻辑。</p> <p>如果你能理解这些 <em>asynquence</em> 代码段，那么你现在就可以相当快地学会这个库；它实际上没有那么难学！</p> <p>如果你依然对它如何（或为什么！）工作感到模糊，那么在进入下一篇附录之前，你将会想要多花一点时间去查看前面的例子，并亲自把玩一下 <em>asynquence</em>。附录B将会在几种更高级更强大的异步模式中使用 <em>asynquence</em>。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/gdut-yy/GitBlogs/edit/github-io/module_book/JS/async&amp;performance/apA.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">10/6/2019, 4:20:30 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/module_book/JS/async&amp;performance/ch6.html" class="prev">
          第六章: 基准分析与调优
        </a></span> <span class="next"><a href="/module_book/JS/async&amp;performance/apB.html">
          附录B: 高级异步模式
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0ac9f99e.js" defer></script><script src="/assets/js/2.4185071d.js" defer></script><script src="/assets/js/69.890073fd.js" defer></script>
  </body>
</html>
